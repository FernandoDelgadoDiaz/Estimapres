<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>EstimaPres ¬∑ Pr√©stamos personales</title>
<link rel="icon" href="assets/ping.png" />
<style>
  :root{--bg:#0e48c7;--bg2:#0a3aa1;--card:#fff;--muted:#6b7280;--ok:#16a34a;--bad:#ef4444;--ink:#0f172a}
  *{box-sizing:border-box}
  html,body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--ink);background:#f5f7fb}
  .hero{background:linear-gradient(135deg,var(--bg),var(--bg2));color:#fff;padding:22px 16px 18px;position:sticky;top:0;z-index:5}
  .brand{display:flex;align-items:center;gap:12px}
  .brand img{width:54px;height:54px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.25)}
  .brand h1{margin:0;font-weight:800;letter-spacing:.2px;font-size:44px;line-height:1}
  .slogan{display:inline-block;margin-top:12px;background:rgba(255,255,255,.14);padding:10px 14px;border-radius:14px}
  .slogan em{font-style:normal;text-decoration:underline;font-weight:600}
  .actions{margin-top:16px;display:flex;gap:14px;overflow-x:auto}
  .btn{display:inline-flex;align-items:center;gap:10px;border:2px solid rgba(255,255,255,.22);background:rgba(255,255,255,.08);color:#fff;padding:10px 14px;border-radius:14px;font-weight:700;font-size:15px}
  .btn.red{background:#e74a4a;border-color:#e74a4a}
  .wrap{max-width:980px;margin:0 auto;padding:18px 14px 80px}
  .card{background:var(--card);border-radius:18px;padding:22px;margin:16px 0;box-shadow:0 10px 24px rgba(2,8,23,.06)}
  .card h2{margin:0 0 12px;font-size:40px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  @media (max-width:760px){.row{grid-template-columns:1fr}.brand h1{font-size:40px}}
  label{font-size:14px;color:var(--muted);display:block;margin:8px 0 6px}
  input{width:100%;padding:14px;border-radius:12px;border:1px solid #e5e7eb;font-size:16px}
  .cta{background:var(--ok);color:#fff;border:none;padding:14px 18px;border-radius:14px;font-weight:800}
  .muted{color:var(--muted)}
</style>
</head>
<body>

<header class="hero">
  <div class="brand">
    <img src="assets/ping.png" alt="EstimaPres" />
    <h1>EstimaPres</h1>
  </div>
  <div class="slogan">Pr√©stamos personales ¬∑ <em>simple y claro</em></div>
  <div class="actions">
    <button id="btnOpenMyLoan" class="btn">üîé Ver mi pr√©stamo</button>
    <button id="btnAdmin" class="btn">üõ°Ô∏è Admin</button>
    <button id="btnLogout" class="btn red">‚Ü™ Salir</button>
  </div>
</header>

<main class="wrap">

<section class="card">
  <h2>Simulador</h2>
  <div class="row">
    <div><label>Monto</label><input id="simAmount" /></div>
    <div><label>Meses</label><input id="simMonths" /></div>
  </div>
  <div class="muted" id="lblCfg"></div>
  <button id="btnSim" class="cta">Simular</button>
  <div id="simResult"></div>
</section>

<section class="card">
  <h2>Solicitar pr√©stamo</h2>
  <div class="row">
    <div><label>Nombre</label><input id="bName"></div>
    <div><label>DNI</label><input id="bDni"></div>
    <div><label>Email</label><input id="bEmail"></div>
    <div><label>Tel√©fono</label><input id="bPhone"></div>
    <div><label>Alias / CBU</label><input id="bAlias"></div>
  </div>
  <button id="btnSendReq" class="cta">Enviar solicitud</button>
</section>

<section id="admin" class="card" style="display:none">
  <h2>Panel administrador</h2>
  <label>TNA %</label><input id="cfgTna">
  <label>Vencimiento</label><input id="cfgDue">
  <button id="btnSaveCfg" class="cta">Guardar</button>
  <p id="forgotPass" class="muted" style="margin-top:12px;cursor:pointer;text-decoration:underline">
    ¬øOlvidaste tu contrase√±a?
  </p>
</section>

</main>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBuLQHhsOBTr2e8Kp5HKUz-a7xXgrgLlUI",
  authDomain: "estimapres.firebaseapp.com",
  projectId: "estimapres",
  storageBucket: "estimapres.firebasestorage.app",
  messagingSenderId: "578516597437",
  appId: "1:578516597437:web:f59994b87729aa1cd655d4"
};

const ADMIN_EMAIL = "fernandogastondelgado81@gmail.com";

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const $ = s => document.querySelector(s);

onAuthStateChanged(auth,(u)=>{
  $("#admin").style.display = (u && u.email===ADMIN_EMAIL) ? "" : "none";
});

$("#btnAdmin").onclick = async()=>{
  if(!auth.currentUser){
    const email = prompt("Email admin:", ADMIN_EMAIL);
    const pass  = prompt("Contrase√±a:");
    try{
      await signInWithEmailAndPassword(auth,email,pass);
    }catch{
      alert("No se pudo iniciar sesi√≥n");
    }
  }
};

$("#btnLogout").onclick = async()=>{ await signOut(auth); };

$("#forgotPass").onclick = async()=>{
  const email = prompt("Ingres√° tu email de administrador:");
  if(!email) return;
  try{
    await sendPasswordResetEmail(auth,email);
    alert("Te enviamos un email para restablecer la contrase√±a.");
  }catch{
    alert("No se pudo enviar el email.");
  }
};

</script>
</body>
</html>