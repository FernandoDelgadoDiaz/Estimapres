<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, user-scalable=yes"/>
<title id="pageTitle">Prestify ¬∑ Tu financiera, digitalizada</title>
<link rel="icon" href="assets/ping.png"/>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{
  --navy:#050d1f;--navy-card:#0c1e3d;--navy-input:#071428;--navy-row:#091630;
  --blue:#1a56db;--blue-light:#2f6ef5;--blue-glow:#3b7cf6;--sky:#60a5fa;--ice:#bfdbfe;
  --white:#ffffff;--text:#e8f0fe;--muted:#94b4d6;
  --border:rgba(96,165,250,.14);--border-hi:rgba(96,165,250,.38);
  --ok:#10b981;--ok-dim:rgba(16,185,129,.14);
  --warn:#f59e0b;--warn-dim:rgba(245,158,11,.14);
  --danger:#ef4444;--danger-dim:rgba(239,68,68,.14);
  --purple:#a78bfa;--purple-dim:rgba(167,139,250,.14);
  --teal:#06b6d4;--teal-dim:rgba(6,182,212,.14);
  --r:20px;--ri:12px;
  --sc:0 8px 32px rgba(5,13,31,.65),0 1px 0 rgba(96,165,250,.07) inset;
  --sb:0 4px 20px rgba(26,86,219,.45);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:'Sora',sans-serif;background:var(--navy);color:var(--text);min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background:radial-gradient(ellipse 80% 60% at 70% -10%,rgba(26,86,219,.17) 0%,transparent 65%),
             radial-gradient(ellipse 50% 40% at 0% 100%,rgba(26,86,219,.11) 0%,transparent 60%),
             repeating-linear-gradient(0deg,transparent,transparent 39px,rgba(96,165,250,.025) 40px),
             repeating-linear-gradient(90deg,transparent,transparent 39px,rgba(96,165,250,.025) 40px)}

/* ===== ANIMACIONES SCROLL ===== */
.fade-up { opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease, transform 0.8s ease; }
.fade-left { opacity: 0; transform: translateX(-30px); transition: opacity 0.8s ease, transform 0.8s ease; }
.fade-right { opacity: 0; transform: translateX(30px); transition: opacity 0.8s ease, transform 0.8s ease; }
.fade-in { opacity: 0; transition: opacity 1s ease; }
.show { opacity: 1; transform: translate(0,0); }

/* ‚ïê‚ïê‚ïê SUSPENDED OVERLAY ‚ïê‚ïê‚ïê */
.suspended-overlay{display:none;position:fixed;inset:0;z-index:9999;background:rgba(5,13,31,.97);backdrop-filter:blur(16px);align-items:center;justify-content:center;flex-direction:column;gap:20px;text-align:center;padding:30px}
.suspended-overlay.show{display:flex}
.suspended-icon{width:80px;height:80px;border-radius:20px;background:var(--danger-dim);border:2px solid rgba(239,68,68,.4);display:flex;align-items:center;justify-content:center;animation:pulse-danger 2s ease infinite}
.suspended-icon svg{width:36px;height:36px;stroke:#f87171;fill:none;stroke-width:1.5}
@keyframes pulse-danger{0%,100%{box-shadow:0 0 0 0 rgba(239,68,68,.4)}60%{box-shadow:0 0 0 16px rgba(239,68,68,0)}}
.suspended-title{font-size:24px;font-weight:800;color:#f87171;letter-spacing:-.5px}
.suspended-msg{font-size:15px;color:var(--muted);line-height:1.65;max-width:460px}
.suspended-msg strong{color:var(--ice)}

/* ‚ïê‚ïê‚ïê ONBOARDING ‚ïê‚ïê‚ïê */
.onboarding-overlay{display:none;position:fixed;inset:0;z-index:600;background:rgba(5,13,31,.97);backdrop-filter:blur(20px);align-items:center;justify-content:center;padding:20px;overflow-y:auto}
.onboarding-overlay.show{display:flex}
.onboarding-box{background:var(--navy-card);border:1px solid var(--border-hi);border-radius:24px;padding:36px;width:100%;max-width:540px;box-shadow:0 32px 80px rgba(5,13,31,.9);animation:fadeUp .4s ease both}
.ob-steps{display:flex;gap:0;margin-bottom:32px;position:relative}
.ob-steps::before{content:'';position:absolute;top:16px;left:16px;right:16px;height:2px;background:var(--border);z-index:0}
.ob-step{display:flex;flex-direction:column;align-items:center;flex:1;position:relative;z-index:1}
.ob-step-dot{width:32px;height:32px;border-radius:50%;border:2px solid var(--border);background:var(--navy);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:800;color:var(--muted);transition:all .3s;flex-shrink:0}
.ob-step.active .ob-step-dot{border-color:var(--sky);background:rgba(96,165,250,.15);color:var(--sky)}
.ob-step.done .ob-step-dot{border-color:var(--ok);background:rgba(16,185,129,.15);color:var(--ok)}
.ob-step-label{font-size:10px;font-weight:600;color:var(--muted);margin-top:6px;text-align:center;letter-spacing:.5px;text-transform:uppercase}
.ob-step.active .ob-step-label{color:var(--sky)}
.ob-step.done .ob-step-label{color:var(--ok)}
.ob-content{display:none}
.ob-content.active{display:block;animation:fadeUp .3s ease both}
.ob-title{font-size:20px;font-weight:800;color:var(--white);margin-bottom:6px;letter-spacing:-.4px}
.ob-subtitle{font-size:13px;color:var(--muted);margin-bottom:24px;line-height:1.6}
.ob-consent-box{background:rgba(5,13,31,.6);border:1px solid var(--border);border-radius:14px;padding:16px;margin-bottom:20px;max-height:140px;overflow-y:auto}
.ob-consent-box p{font-size:11px;color:var(--muted);line-height:1.7;margin-bottom:6px}
.ob-consent-box strong{color:var(--ice)}
.ob-consent-check{display:flex;align-items:flex-start;gap:10px;padding:12px 14px;background:rgba(26,86,219,.08);border:1px solid var(--border-hi);border-radius:10px;cursor:pointer;margin-bottom:20px}
.ob-consent-check input[type=checkbox]{width:16px;height:16px;margin-top:1px;flex-shrink:0;accent-color:var(--sky);cursor:pointer}
.ob-consent-check label{font-size:12px;color:var(--ice);line-height:1.5;cursor:pointer}
.ob-sig-wrap{border:2px dashed var(--border-hi);border-radius:14px;overflow:hidden;background:rgba(5,13,31,.6);touch-action:none;margin-bottom:16px}
#obSigCanvas{display:block;width:100%;height:150px;cursor:crosshair}
.ob-nav{display:flex;gap:10px;margin-top:20px}
.payment-method-selector{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px}
.pm-option{padding:16px;border:2px solid var(--border);border-radius:14px;cursor:pointer;transition:all .2s;text-align:center}
.pm-option:hover{border-color:var(--border-hi)}
.pm-option.selected{border-color:var(--sky);background:rgba(96,165,250,.08)}
.pm-option .pm-icon{font-size:24px;margin-bottom:8px}
.pm-option .pm-name{font-size:13px;font-weight:700;color:var(--white)}
.pm-option .pm-desc{font-size:11px;color:var(--muted);margin-top:3px;line-height:1.4}

/* TOPBAR */
.topbar{position:sticky;top:0;z-index:200;background:rgba(5,13,31,.92);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.topbar-inner{max-width:1200px;margin:0 auto;padding:0 28px;height:66px;display:flex;align-items:center;gap:24px}
.logo{display:flex;align-items:center;gap:10px;text-decoration:none;flex-shrink:0;cursor:pointer}
.logo-mark{width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,var(--blue-light),var(--sky));display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:#fff;box-shadow:0 0 18px rgba(47,110,245,.5);overflow:hidden}
.logo-mark img{width:100%;height:100%;object-fit:cover;border-radius:10px}
.logo-name{font-size:18px;font-weight:700;color:var(--white);letter-spacing:-.4px}
.logo-name span{color:var(--sky)}
.topbar-nav{display:flex;align-items:center;gap:4px;margin-left:auto}
.nav-btn{display:inline-flex;align-items:center;gap:7px;padding:8px 13px;border-radius:10px;border:1px solid transparent;background:transparent;color:var(--muted);font-family:inherit;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;white-space:nowrap}
.nav-btn svg{width:15px;height:15px;stroke:currentColor;fill:none;stroke-width:2;flex-shrink:0}
.nav-btn:hover{background:rgba(96,165,250,.08);border-color:var(--border);color:var(--white)}
.nav-btn.active{background:rgba(26,86,219,.15);border-color:var(--border-hi);color:var(--sky)}
.nav-btn.danger{color:#f87171}
.nav-btn.danger:hover{background:var(--danger-dim);border-color:rgba(239,68,68,.3)}
.nav-sep{width:1px;height:24px;background:var(--border);margin:0 4px}
.notif-wrap{position:relative}
.notif-bell{position:relative;display:inline-flex;align-items:center;justify-content:center;width:38px;height:38px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;transition:all .2s}
.notif-bell:hover{background:rgba(96,165,250,.08);border-color:var(--border-hi);color:var(--white)}
.notif-bell svg{width:17px;height:17px;stroke:currentColor;fill:none;stroke-width:2}
.notif-badge{position:absolute;top:-5px;right:-5px;min-width:18px;height:18px;padding:0 4px;background:var(--danger);border-radius:9px;border:2px solid var(--navy);font-size:10px;font-weight:800;color:#fff;display:flex;align-items:center;justify-content:center;animation:pulse-badge 1.5s ease infinite}
@keyframes pulse-badge{0%,100%{box-shadow:0 0 0 0 rgba(239,68,68,.6)}60%{box-shadow:0 0 0 6px rgba(239,68,68,0)}}
.notif-dropdown{display:none;position:absolute;top:calc(100% + 10px);right:0;width:340px;background:var(--navy-card);border:1px solid var(--border-hi);border-radius:16px;box-shadow:0 16px 48px rgba(5,13,31,.8);z-index:500;overflow:hidden}
.notif-dropdown.open{display:block;animation:fadeUp .2s ease}
.notif-header{padding:14px 16px;border-bottom:1px solid var(--border);font-size:12px;font-weight:700;color:var(--sky);text-transform:uppercase;letter-spacing:1px;display:flex;justify-content:space-between}
.notif-list{max-height:300px;overflow-y:auto}
.notif-item{padding:12px 16px;border-bottom:1px solid rgba(96,165,250,.06);cursor:pointer}
.notif-item:hover{background:rgba(96,165,250,.05)}
.notif-item.unread{border-left:3px solid var(--sky)}
.notif-item-title{font-size:13px;font-weight:700;color:var(--white);margin-bottom:2px}
.notif-item-sub{font-size:11px;color:var(--muted)}
.notif-empty{padding:24px;text-align:center;color:var(--muted);font-size:13px}
.alert-banner{display:none;position:fixed;top:72px;left:50%;transform:translateX(-50%);z-index:400;padding:14px 20px 14px 18px;background:linear-gradient(135deg,rgba(26,86,219,.97),rgba(47,110,245,.97));border:1px solid rgba(96,165,250,.5);border-radius:14px;color:#fff;font-size:14px;font-weight:700;box-shadow:0 10px 40px rgba(26,86,219,.6);align-items:center;gap:12px;max-width:90vw}
.alert-banner.show{display:flex;animation:slideDown .35s ease}
@keyframes slideDown{from{opacity:0;transform:translateX(-50%) translateY(-16px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
.alert-banner-close{background:rgba(255,255,255,.18);border:none;color:#fff;width:22px;height:22px;border-radius:6px;cursor:pointer;font-size:13px;display:flex;align-items:center;justify-content:center}
.hero-section{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:56px 28px 44px;display:grid;grid-template-columns:1fr auto;gap:40px;align-items:center}
.hero-eyebrow{display:inline-flex;align-items:center;gap:8px;padding:5px 12px;border-radius:999px;margin-bottom:18px;background:rgba(26,86,219,.18);border:1px solid var(--border-hi);font-size:11px;font-weight:600;color:var(--sky);letter-spacing:1.2px;text-transform:uppercase}
.hero-eyebrow::before{content:'';width:6px;height:6px;border-radius:50%;background:var(--sky)}
.hero-title{font-size:clamp(30px,4vw,50px);font-weight:800;line-height:1.1;letter-spacing:-1.5px;color:var(--white);margin-bottom:14px}
.hero-title em{font-style:normal;background:linear-gradient(90deg,var(--sky),var(--blue-glow));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero-sub{font-size:15px;color:var(--muted);line-height:1.65;max-width:460px}
.hero-badges{display:flex;gap:10px;margin-top:28px;flex-wrap:wrap}
.badge{display:flex;align-items:center;gap:7px;padding:8px 13px;background:var(--navy-card);border:1px solid var(--border);border-radius:11px;font-size:12px;font-weight:600;color:var(--ice)}
.badge svg{width:13px;height:13px;stroke:var(--sky);fill:none;stroke-width:2}
.hero-kpis{display:grid;gap:10px}
.kpi-box{background:var(--navy-card);border:1px solid var(--border);border-radius:16px;padding:18px 22px;text-align:right;min-width:170px}
.kpi-label{font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;font-weight:600}
.kpi-value{font-size:26px;font-weight:800;color:var(--white);letter-spacing:-1px;margin-top:4px;font-family:'DM Mono',monospace}
.kpi-value small{font-size:13px;color:var(--sky);margin-left:3px}
.main-wrap{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:0 28px 80px}
.client-grid{display:grid;grid-template-columns:1fr 1fr;gap:22px}
.full-width{grid-column:1/-1}
.admin-wrap{display:none}
.admin-wrap.visible{display:block}
.card{background:var(--navy-card);border:1px solid var(--border);border-radius:var(--r);padding:26px;box-shadow:var(--sc);position:relative;overflow:hidden}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(96,165,250,.35),transparent)}
.card-title{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--sky);margin-bottom:20px;display:flex;align-items:center;gap:8px}
.card-title svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2.5}
.sep{height:1px;background:var(--border);margin:18px 0}
.dashboard-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:24px}
.dash-card{background:var(--navy-card);border:1px solid var(--border);border-radius:16px;padding:20px}
.dash-card:hover{border-color:var(--border-hi)}
.dash-icon{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;justify-content:center;margin-bottom:14px}
.dash-icon svg{width:18px;height:18px;stroke:currentColor;fill:none;stroke-width:2}
.dash-icon.blue{background:rgba(26,86,219,.2);color:var(--sky)}
.dash-icon.green{background:rgba(16,185,129,.2);color:var(--ok)}
.dash-icon.red{background:var(--danger-dim);color:#f87171}
.dash-label{font-size:10px;color:var(--muted);font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:6px}
.dash-value{font-family:'DM Mono',monospace;font-size:22px;font-weight:700;color:var(--white)}
.field{margin-bottom:16px}
.field label{display:block;font-size:11px;font-weight:700;color:var(--ice);text-transform:uppercase;letter-spacing:.9px;margin-bottom:7px}
.field input,.field select,.field textarea{width:100%;background:rgba(7,20,40,.85);border:1px solid rgba(96,165,250,.28);border-radius:var(--ri);padding:12px 15px;color:#f0f6ff;font-family:'Sora',sans-serif;font-size:14px;font-weight:500;outline:none}
.field input:focus,.field select:focus{border-color:var(--blue-glow);box-shadow:0 0 0 3px rgba(59,124,246,.18)}
.input-row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.btn-primary{width:100%;padding:13px 20px;border:none;border-radius:var(--ri);background:linear-gradient(135deg,var(--blue-light),var(--blue));color:#fff;font-family:'Sora',sans-serif;font-size:14px;font-weight:700;cursor:pointer;box-shadow:var(--sb);display:flex;align-items:center;justify-content:center;gap:8px}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 6px 28px rgba(26,86,219,.55)}
.btn-success{padding:10px 16px;background:var(--ok-dim);border:1px solid rgba(16,185,129,.3);border-radius:10px;color:var(--ok);font-weight:700;cursor:pointer}
.btn-danger{padding:10px 16px;background:var(--danger-dim);border:1px solid rgba(239,68,68,.25);border-radius:10px;color:#f87171;cursor:pointer}
.btn-outline{padding:10px 16px;background:transparent;border:1px solid var(--border);border-radius:10px;color:var(--ice);cursor:pointer}
.btn-sm{padding:6px 11px!important;font-size:11px!important}
.toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
.pill{display:inline-flex;align-items:center;gap:5px;padding:3px 9px;border-radius:999px;font-size:11px;font-weight:700}
.pill::before{content:'';width:5px;height:5px;border-radius:50%}
.pill.ok{background:var(--ok-dim);color:#34d399}.pill.ok::before{background:var(--ok)}
.pill.warn{background:var(--warn-dim);color:#fbbf24}.pill.warn::before{background:var(--warn)}
.pill.bad{background:var(--danger-dim);color:#f87171}.pill.bad::before{background:var(--danger)}
.schedule-wrap{border:1px solid var(--border);border-radius:14px;overflow:hidden;margin-top:14px}
.schedule-header{display:grid;grid-template-columns:38px 1fr 110px 1fr;gap:8px;padding:9px 14px;background:rgba(5,13,31,.65);border-bottom:1px solid var(--border)}
.schedule-header span{font-size:10px;font-weight:700;text-transform:uppercase;color:var(--muted)}
.schedule-row{display:grid;grid-template-columns:38px 1fr 110px 1fr;gap:8px;align-items:center;padding:11px 14px;border-bottom:1px solid rgba(96,165,250,.05)}
.schedule-row .num{font-family:'DM Mono',monospace;font-size:12px;color:var(--muted)}
.schedule-row .date{font-size:13px;color:var(--ice)}
.schedule-row .amount{font-family:'DM Mono',monospace;font-size:13px;color:var(--white)}
.sim-result-box{margin-top:18px;padding:18px;background:rgba(5,13,31,.5);border:1px solid var(--border-hi);border-radius:16px}
.sim-cuota-value{font-family:'DM Mono',monospace;font-size:30px;color:var(--sky)}
.admin-tabs{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:20px}
.tab-btn{padding:9px 16px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--muted);font-size:13px;font-weight:600;cursor:pointer}
.tab-btn.active{background:rgba(26,86,219,.18);border-color:var(--border-hi);color:var(--sky)}
.tab-content{display:none}
.tab-content.visible{display:block}
.modal-overlay{display:none;position:fixed;inset:0;z-index:300;background:rgba(5,13,31,.92);backdrop-filter:blur(10px);align-items:center;justify-content:center;padding:20px}
.modal-overlay.open{display:flex}
.modal-box{background:var(--navy-card);border:1px solid var(--border-hi);border-radius:22px;padding:26px;width:100%;max-width:460px}
.sig-canvas-wrap{border:2px dashed var(--border-hi);border-radius:14px;overflow:hidden;background:rgba(5,13,31,.6);touch-action:none}
#sigCanvas{display:block;width:100%;height:170px;cursor:crosshair}
.pending-overlay{display:none;position:fixed;inset:0;z-index:8000;background:rgba(5,13,31,.98);backdrop-filter:blur(20px);align-items:center;justify-content:center;flex-direction:column;gap:22px;text-align:center;padding:30px}
.pending-overlay.show{display:flex}
.pending-logo-mark{width:72px;height:72px;border-radius:18px;background:linear-gradient(135deg,var(--blue-light),var(--sky));display:flex;align-items:center;justify-content:center;font-size:26px;font-weight:800;color:#fff}
.pending-badge{display:inline-flex;align-items:center;gap:8px;padding:8px 16px;background:var(--warn-dim);border:1px solid rgba(245,158,11,.3);border-radius:999px;font-size:12px;font-weight:700;color:var(--warn)}
.plazo-grid{display:grid;grid-template-columns:repeat(8,1fr);gap:6px;margin-top:8px}
.plazo-check{display:none}
.plazo-label{display:flex;align-items:center;justify-content:center;height:34px;border:1px solid var(--border);border-radius:8px;font-size:12px;font-weight:700;color:var(--muted);cursor:pointer}
.plazo-check:checked+.plazo-label{background:rgba(26,86,219,.2);border-color:var(--sky);color:var(--sky)}
.breakdown-box{background:rgba(5,13,31,.5);border:1px solid var(--border-hi);border-radius:12px;padding:14px;margin-bottom:12px}
.breakdown-row{display:flex;justify-content:space-between;padding:5px 0;border-bottom:1px solid rgba(96,165,250,.06);font-size:12px}
.breakdown-row:last-child{border-bottom:none;font-weight:700}
/* ===== SUPERADMIN PANEL PROFESIONAL ===== */
.superadmin-view{display:none;position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:32px 28px 80px;background:var(--navy);min-height:100vh}
.superadmin-view.show{display:block}
.sa-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:28px;gap:16px;flex-wrap:wrap}
.sa-title{font-size:26px;font-weight:800;color:var(--white);display:flex;align-items:center;gap:12px}
.sa-badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;background:rgba(239,68,68,.15);border:1px solid rgba(239,68,68,.35);border-radius:999px;font-size:11px;font-weight:700;color:#f87171}
.sa-metrics{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:28px}
@media(max-width:768px){.sa-metrics{grid-template-columns:1fr 1fr}}
.sa-metric-card{background:var(--navy-card);border:1px solid var(--border);border-radius:16px;padding:20px}
.sa-metric-label{font-size:10px;color:var(--muted);text-transform:uppercase;font-weight:700;margin-bottom:8px}
.sa-metric-val{font-family:'DM Mono',monospace;font-size:28px;font-weight:800;color:var(--white)}
.sa-lenders-table{background:var(--navy-card);border:1px solid var(--border);border-radius:20px;overflow:hidden}
.sa-table-header{padding:18px 24px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.sa-table-title{font-size:13px;font-weight:700;color:var(--sky);text-transform:uppercase}
.sa-row{display:grid;grid-template-columns:1fr 200px 120px 140px;gap:16px;align-items:center;padding:16px 24px;border-bottom:1px solid rgba(96,165,250,.06)}
.sa-row-head{background:rgba(5,13,31,.5);font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase}
.sa-lender-name{font-size:14px;font-weight:700;color:var(--white)}
.sa-lender-email{font-size:11px;color:var(--muted)}
.sa-status-pill{display:inline-flex;align-items:center;gap:5px;padding:4px 10px;border-radius:999px;font-size:11px;font-weight:700}
.sa-status-pill.activo{background:var(--ok-dim);color:var(--ok)}
.sa-status-pill.pendiente{background:var(--warn-dim);color:var(--warn)}
.sa-status-pill.pausado{background:var(--danger-dim);color:#f87171}
.sa-action-btn{padding:7px 14px;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;border:1px solid;background:transparent}
.sa-btn-activate{background:var(--ok-dim);border-color:rgba(16,185,129,.3);color:var(--ok)}
.sa-btn-activate:hover{background:rgba(16,185,129,.22)}
.sa-btn-suspend{background:var(--danger-dim);border-color:rgba(239,68,68,.25);color:#f87171}
.sa-btn-suspend:hover{background:rgba(239,68,68,.22)}
.toast-container{position:fixed;bottom:24px;right:24px;z-index:999;display:flex;flex-direction:column;gap:8px}
.toast{padding:12px 18px;border-radius:12px;font-size:13px;font-weight:600;display:flex;align-items:center;gap:10px}
.toast.ok{background:#0c2e1f;border:1px solid rgba(16,185,129,.3);color:#34d399}
.toast.err{background:#2a0c0c;border:1px solid rgba(239,68,68,.3);color:#f87171}
.empty{padding:28px 20px;text-align:center;color:var(--muted);font-size:13px}
.spinner{width:20px;height:20px;border:2px solid rgba(96,165,250,.2);border-top-color:var(--sky);border-radius:50%;animation:spin .8s linear infinite;margin:0 auto}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}

/* ===== LANDING PAGE DE ALTO IMPACTO ===== */
.landing-view{display:none;position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:60px 28px 80px}
.landing-view.show{display:block}
.landing-hero{text-align:center;margin-bottom:64px}
.landing-eyebrow{display:inline-flex;align-items:center;gap:8px;padding:6px 16px;border-radius:999px;background:rgba(26,86,219,.18);border:1px solid var(--border-hi);font-size:11px;font-weight:700;color:var(--sky);margin-bottom:28px}
.landing-eyebrow::before{content:'';width:6px;height:6px;border-radius:50%;background:var(--sky)}
.landing-title{font-size:clamp(36px,5vw,64px);font-weight:800;line-height:1.08;letter-spacing:-2px;color:var(--white);margin-bottom:20px}
.landing-title em{font-style:normal;background:linear-gradient(90deg,var(--sky),#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.landing-sub{font-size:17px;color:var(--muted);line-height:1.7;max-width:560px;margin:0 auto 36px}
.landing-cta{display:inline-flex;align-items:center;gap:12px;padding:18px 36px;background:linear-gradient(135deg,var(--blue-light),var(--sky));border:none;border-radius:16px;color:#fff;font-weight:800;cursor:pointer}
.landing-cta:hover{transform:translateY(-3px);box-shadow:0 14px 44px rgba(47,110,245,.65)}
.landing-cta svg{width:20px;height:20px;stroke:currentColor;fill:none}
.trust-metrics {
  display: grid;
  grid-template-columns: repeat(4,1fr);
  gap: 24px;
  margin: 60px 0;
}
.trust-card {
  background: linear-gradient(145deg, #132237, #0e1a2b);
  border: 1px solid #2d4055;
  border-radius: 24px;
  padding: 32px 20px;
  text-align: center;
  box-shadow: 0 12px 30px rgba(0,0,0,0.5);
}
.trust-number {
  font-size: 42px;
  font-weight: 800;
  background: linear-gradient(135deg, #fff, #a0c0ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  line-height: 1.2;
}
.trust-label {
  font-size: 14px;
  color: #8ba0c0;
  margin-top: 8px;
  text-transform: uppercase;
  letter-spacing: 1px;
}
.features-grid {
  display: grid;
  grid-template-columns: repeat(3,1fr);
  gap: 24px;
  margin: 60px 0;
}
.feature-card {
  background: #132237;
  border: 1px solid #2d4055;
  border-radius: 24px;
  padding: 28px;
  transition: transform 0.2s;
}
.feature-card:hover {
  transform: translateY(-5px);
  border-color: #4f7df3;
}
.feature-card img {
  width: 100%;
  border-radius: 16px;
  margin-bottom: 16px;
}
.feature-card h3 {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 12px;
  color: white;
}
.feature-card p {
  color: #b0c4de;
  line-height: 1.6;
}
.testimonials-section {
  margin: 80px 0;
  text-align: center;
}
.section-title {
  font-size: 32px;
  font-weight: 800;
  margin-bottom: 40px;
  background: linear-gradient(135deg, #fff, #c0d0ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.testimonials-grid {
  display: grid;
  grid-template-columns: repeat(3,1fr);
  gap: 24px;
}
.testimonial-card {
  background: #132237;
  border: 1px solid #2d4055;
  border-radius: 24px;
  padding: 28px;
  text-align: left;
}
.testimonial-stars {
  color: #fbbf24;
  font-size: 18px;
  margin-bottom: 12px;
}
.testimonial-text {
  color: #e0e8f0;
  font-style: italic;
  line-height: 1.6;
  margin-bottom: 16px;
}
.testimonial-author {
  color: #8ba0c0;
  font-weight: 600;
}
.landing-cta.large {
  padding: 20px 48px;
  font-size: 18px;
}
.landing-cta-section {
  text-align: center;
  background: linear-gradient(135deg, rgba(26,86,219,.15), rgba(96,165,250,.08));
  border: 1px solid var(--border-hi);
  border-radius: 24px;
  padding: 52px 40px;
  margin-top: 60px;
}
.landing-cta-section h2 {
  font-size: clamp(24px, 3vw, 38px);
  font-weight: 800;
  color: var(--white);
  letter-spacing: -1px;
  margin-bottom: 12px;
}
.landing-cta-section p {
  font-size: 15px;
  color: var(--muted);
  margin-bottom: 32px;
  line-height: 1.6;
}
@media (max-width: 768px) {
  .trust-metrics, .features-grid, .testimonials-grid {
    grid-template-columns: 1fr;
  }
}

/* ===== CLIENTE ESTILO MONI ===== */
body.client-mode {
  background: #F5F7FA;
}
body.client-mode::before { display:none; }
body.client-mode .topbar {
  background: rgba(255,255,255,0.95);
  border-bottom: 1px solid rgba(0,0,0,0.08);
  box-shadow: 0 2px 12px rgba(0,0,0,0.06);
}
body.client-mode .logo-name { color: #111; }
body.client-mode .nav-btn { color: #666; }
body.client-mode .nav-btn:hover { background: rgba(0,0,0,0.05); color: #111; border-color: rgba(0,0,0,0.1); }
body.client-mode .nav-btn.active { background: rgba(0,0,0,0.07); color: #111; border-color: rgba(0,0,0,0.15); }
body.client-mode .hero-section { display: none; }
body.client-mode .card {
  background: #fff;
  border: 1px solid rgba(0,0,0,0.07);
  box-shadow: 0 4px 24px rgba(0,0,0,0.06), 0 1px 4px rgba(0,0,0,0.04);
  border-radius: 20px;
}
body.client-mode .card::before { display:none; }
body.client-mode .card-title { color: #555; letter-spacing: 1px; }
body.client-mode .lender-brand-header {
  text-align: center;
  padding: 28px 20px 8px;
}
body.client-mode .lender-brand-name {
  font-size: clamp(26px, 5vw, 38px);
  font-weight: 800;
  color: #111;
  letter-spacing: -1px;
  margin-bottom: 6px;
}
body.client-mode .field label {
  color: #444;
  text-transform: none;
  font-size: 13px;
  font-weight: 600;
}
body.client-mode .field input,
body.client-mode .field select {
  background: #F5F7FA;
  border: 1.5px solid #E2E8F0;
  color: #111;
  border-radius: 14px;
}
body.client-mode .client-amount-slider {
  -webkit-appearance: none;
  width: 100%;
  height: 6px;
  background: #E2E8F0;
  border-radius: 999px;
  margin: 12px 0;
}
body.client-mode .client-amount-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--brand-color, #1a56db);
  box-shadow: 0 2px 8px rgba(26,86,219,0.4);
  cursor: pointer;
  border: 3px solid #fff;
}
body.client-mode .client-amount-display {
  font-size: 42px;
  font-weight: 800;
  color: var(--brand-color, #1a56db);
  text-align: center;
}
body.client-mode .client-pill {
  flex: 1;
  padding: 12px 8px;
  border: 2px solid #E2E8F0;
  border-radius: 40px;
  background: white;
  color: #64748b;
  font-weight: 600;
  cursor: pointer;
  text-align: center;
}
body.client-mode .client-pill.active {
  background: var(--brand-color, #1a56db);
  color: white;
  border-color: var(--brand-color, #1a56db);
}
body.client-mode .btn-primary {
  background: var(--brand-color, #1a56db) !important;
  border-radius: 40px;
  padding: 16px;
  font-size: 16px;
}

/* ===== RESPONSIVE GENERAL ===== */
@media (max-width: 768px) {
  .topbar-inner { padding: 0 12px; flex-wrap: wrap; }
  .topbar-nav { order: 3; width: 100%; justify-content: space-around; }
  .nav-btn .nav-label { font-size: 10px; }
  .hero-section { padding: 30px 16px; }
  .hero-title { font-size: 28px; }
  .hero-kpis { grid-template-columns: 1fr; }
  .dashboard-grid { grid-template-columns: 1fr 1fr; }
  .client-grid { grid-template-columns: 1fr; }
  .schedule-header { display: none; }
  .schedule-row {
    grid-template-columns: 1fr 1fr;
    border: 1px solid var(--border);
    border-radius: 8px;
    margin-bottom: 8px;
    padding: 10px;
  }
  .schedule-row .num { grid-column: 1; grid-row: 1; }
  .schedule-row .date { grid-column: 2; grid-row: 1; text-align: right; }
  .schedule-row .amount { grid-column: 1; grid-row: 2; font-size: 16px; }
  .schedule-row .action-col { grid-column: 2; grid-row: 2; justify-content: flex-end; }
}
</style>
</head>
<body>

<!-- ===== LANDING PAGE DE ALTO IMPACTO ===== -->
<div class="landing-view" id="landingView">
  <div class="landing-hero fade-up">
    <div class="landing-eyebrow">‚ú® Plataforma #1 para prestamistas</div>
    <h1 class="landing-title">Digitaliz√° tu negocio<br><em>de pr√©stamos en minutos</em></h1>
    <p class="landing-sub">La soluci√≥n todo-en-uno para administrar pr√©stamos, clientes y cobranzas. Sin c√≥digo, sin papeles, sin complicaciones.</p>
    <button class="landing-cta" id="btnLandingRegister">
      <svg viewBox="0 0 24 24" width="20" height="20" stroke="white" fill="none"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
      Crear mi financiera gratis
    </button>
    <p class="landing-demo">¬øYa ten√©s cuenta? <a href="#" id="btnLandingLogin">Iniciar sesi√≥n</a></p>
  </div>

  <div class="features-grid">
    <div class="feature-card fade-left">
      <img src="assets/1772058249023.png" alt="Dashboard" loading="lazy">
      <h3>Dashboard potente</h3>
      <p>Visualiz√° toda tu operaci√≥n en tiempo real.</p>
    </div>
    <div class="feature-card fade-up">
      <img src="assets/1772058267760.png" alt="Mobile" loading="lazy">
      <h3>Desde el celular</h3>
      <p>Tus clientes solicitan pr√©stamos desde su tel√©fono.</p>
    </div>
    <div class="feature-card fade-right">
      <img src="assets/1772058471896.png" alt="Confianza" loading="lazy">
      <h3>Confianza y respaldo</h3>
      <p>M√°s de 200 prestamistas ya conf√≠an en nosotros.</p>
    </div>
  </div>

  <div class="trust-metrics">
    <div class="trust-card fade-up"><div class="trust-number">+200</div><div class="trust-label">prestamistas activos</div></div>
    <div class="trust-card fade-up"><div class="trust-number">4.9</div><div class="trust-label">satisfacci√≥n ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div></div>
    <div class="trust-card fade-up"><div class="trust-number">$2.5B</div><div class="trust-label">prestados en 2024</div></div>
    <div class="trust-card fade-up"><div class="trust-number">0%</div><div class="trust-label">costo de instalaci√≥n</div></div>
  </div>

  <div class="testimonials-section">
    <h2 class="section-title fade-in">Clientes satisfechos</h2>
    <div class="testimonials-grid">
      <div class="testimonial-card fade-left">
        <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        <p class="testimonial-text">"En un mes ya ten√≠a mi primera financiera funcionando. Mis clientes pueden solicitar pr√©stamos desde su celular y yo gestiono todo desde el panel."</p>
        <div class="testimonial-author">‚Äî Carlos G., C√≥rdoba</div>
      </div>
      <div class="testimonial-card fade-up">
        <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        <p class="testimonial-text">"La firma digital me ahorr√≥ horas de papeleo. Los contratos son v√°lidos y los clientes los firman en segundos."</p>
        <div class="testimonial-author">‚Äî Marta L., Buenos Aires</div>
      </div>
      <div class="testimonial-card fade-right">
        <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        <p class="testimonial-text">"El soporte es incre√≠ble. Me ayudaron a configurar todo y ahora tengo un negocio profesional que crece solo."</p>
        <div class="testimonial-author">‚Äî Javier R., Mendoza</div>
      </div>
    </div>
  </div>

  <div class="landing-cta-section fade-up">
    <h2>Empez√° hoy, es gratis</h2>
    <p>Cre√° tu cuenta en menos de 3 minutos y comenz√° a ofrecer pr√©stamos digitales.</p>
    <button class="landing-cta large" id="btnLandingRegister2">
      <svg viewBox="0 0 24 24" width="20" height="20" stroke="white" fill="none"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" y1="8" x2="19" y2="14"/><line x1="22" y1="11" x2="16" y2="11"/></svg>
      Crear mi cuenta gratis
    </button>
  </div>
</div>

<!-- ===== SUPERADMIN PANEL PROFESIONAL ===== -->
<div class="superadmin-view" id="superadminView">
  <div class="sa-header">
    <div class="sa-title">üõ°Ô∏è Panel SuperAdmin <span class="sa-badge">Due√±o</span></div>
    <button class="btn-outline btn-sm" id="btnSaLogout">Cerrar sesi√≥n</button>
  </div>
  <div class="sa-metrics" id="saMetrics">
    <div class="sa-metric-card"><div class="sa-metric-label">Prestamistas</div><div class="sa-metric-val" id="saCountLenders">‚Äî</div></div>
    <div class="sa-metric-card"><div class="sa-metric-label">Activos</div><div class="sa-metric-val" id="saCountActive">‚Äî</div></div>
    <div class="sa-metric-card"><div class="sa-metric-label">Pendientes</div><div class="sa-metric-val" id="saCountPending">‚Äî</div></div>
    <div class="sa-metric-card"><div class="sa-metric-label">Pr√©stamos totales</div><div class="sa-metric-val" id="saCountLoans">‚Äî</div></div>
    <div class="sa-metric-card"><div class="sa-metric-label">Volumen operado</div><div class="sa-metric-val" id="saVolume">‚Äî</div></div>
  </div>
  <div class="sa-lenders-table">
    <div class="sa-table-header">
      <span class="sa-table-title">üìã Solicitudes y prestamistas</span>
      <button class="btn-outline btn-sm" onclick="window.loadSuperAdmin()">‚Üª Actualizar</button>
    </div>
    <div id="saLendersList"><div class="sa-loading"><div class="spinner"></div></div></div>
  </div>
</div>
<!-- ===== RESTO DE OVERLAYS Y MODALES ORIGINALES (TAL CUAL) ===== -->
<div class="pending-overlay" id="pendingOverlay">
  <div class="pending-logo-wrap">
    <div class="pending-logo-mark" id="pendingLogoMark">P</div>
    <div class="pending-logo-name">Presti<span>fy</span></div>
  </div>
  <div class="pending-badge">‚è≥ Validaci√≥n pendiente</div>
  <div class="pending-title">Tu financiera est√° siendo validada</div>
  <div class="pending-msg">Estamos revisando tu registro para activar tu cuenta.<br><strong>Te contactaremos a la brevedad</strong> para confirmar la activaci√≥n de tu financiera digital.</div>
  <a href="https://wa.me/542966678029?text=Hola%2C+quiero+activar+mi+cuenta+en+Prestify" target="_blank" style="padding:14px 28px;background:rgba(37,211,102,.15);border:1px solid rgba(37,211,102,.35);border-radius:12px;color:#25d366;font-weight:700;font-size:14px;text-decoration:none;display:flex;align-items:center;gap:10px;margin-top:4px">
    <svg viewBox="0 0 24 24" style="width:18px;height:18px;fill:currentColor"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>
    Contactar para activar mi cuenta
  </a>
  <button id="btnPendingLogout" style="padding:9px 20px;background:transparent;border:1px solid var(--border);border-radius:10px;color:var(--muted);font-family:inherit;font-size:13px;cursor:pointer;margin-top:4px">Cerrar sesi√≥n</button>
</div>

<div class="suspended-overlay" id="suspendedOverlay">
  <div class="suspended-icon">
    <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/></svg>
  </div>
  <div class="suspended-title">Cuenta suspendida</div>
  <div class="suspended-msg">Tu cuenta ha sido <strong>pausada por falta de pago</strong> o incumplimiento de los t√©rminos del servicio.<br><br>Para reactivarla, contact√° al soporte de la plataforma.</div>
  <a href="mailto:soporte@dineroya.com" style="padding:13px 28px;background:rgba(239,68,68,.15);border:1px solid rgba(239,68,68,.35);border-radius:12px;color:#f87171;font-weight:700;font-size:14px;text-decoration:none;margin-top:8px">Contactar soporte</a>
</div>

<!-- MODAL REGISTRO NUEVO PRESTAMISTA -->
<div class="register-modal-overlay" id="registerModalOverlay">
  <div class="register-modal-box">
    <button class="register-modal-close" id="btnCloseRegisterModal">‚úï</button>
    <div class="register-modal-logo">
      <div class="logo-mark">P</div>
      <div class="logo-name">Prestify</div>
    </div>
    <div class="register-modal-title">Cre√° tu financiera digital</div>
    <div class="register-modal-sub">Ingres√° tu email y eleg√≠ una contrase√±a segura. En 3 pasos simples ten√©s tu financiera lista.</div>
    <div class="register-modal-error" id="registerModalError"></div>
    <div class="field">
      <label>Email</label>
      <input type="email" id="regEmail" placeholder="tucorreo@ejemplo.com" autocomplete="email"/>
    </div>
    <div class="field">
      <label>Contrase√±a</label>
      <input type="password" id="regPassword" placeholder="M√≠nimo 6 caracteres" autocomplete="new-password"/>
    </div>
    <div class="field">
      <label>Confirm√° la contrase√±a</label>
      <input type="password" id="regPasswordConfirm" placeholder="Repet√≠ tu contrase√±a" autocomplete="new-password"/>
    </div>
    <button class="register-modal-btn" id="btnDoRegister">Crear cuenta y continuar ‚Üí</button>
    <div class="register-modal-switch">¬øYa ten√©s cuenta? <a id="btnSwitchToLogin">Inici√° sesi√≥n</a></div>
  </div>
</div>

<!-- ONBOARDING OVERLAY (3 pasos) -->
<div class="onboarding-overlay" id="onboardingOverlay">
  <div class="onboarding-box">
    <div class="ob-steps">
      <div class="ob-step active" id="obStep1">
        <div class="ob-step-dot">1</div>
        <div class="ob-step-label">Datos personales</div>
      </div>
      <div class="ob-step" id="obStep2">
        <div class="ob-step-dot">2</div>
        <div class="ob-step-label">Tu financiera</div>
      </div>
      <div class="ob-step" id="obStep3">
        <div class="ob-step-dot">3</div>
        <div class="ob-step-label">Montos y TNA</div>
      </div>
    </div>

    <!-- PASO 1: Datos personales -->
    <div class="ob-content active" id="obContent1">
      <div class="ob-title">Tus datos personales</div>
      <div class="ob-subtitle">Necesitamos verificar tu identidad para crear tu cuenta de prestamista.</div>
      <div class="input-row" style="margin-bottom:16px">
        <div class="field" style="margin-bottom:0"><label>Nombre completo</label><input id="obName" placeholder="Juan P√©rez"/></div>
        <div class="field" style="margin-bottom:0"><label>DNI</label><input id="obDni" inputmode="numeric" placeholder="30123456"/></div>
      </div>
      <div class="field" style="margin-bottom:16px"><label>Email</label><input id="obEmail" type="email" placeholder="correo@mail.com"/></div>

      <div class="ob-consent-box">
        <p><strong>T√©rminos de Uso de la Plataforma DineroYa</strong></p>
        <p>Al registrarte y utilizar esta plataforma, acept√°s los siguientes t√©rminos:</p>
        <p>1. El uso de la plataforma est√° sujeto al pago de las suscripciones o tarifas vigentes seg√∫n el plan contratado.</p>
        <p>2. <strong>El administrador de la plataforma se reserva el derecho de pausar o eliminar la cuenta en caso de incumplimiento de pagos, uso indebido del servicio, o incumplimiento de cualquier t√©rmino y condici√≥n aqu√≠ establecido.</strong></p>
        <p>3. El prestador es el √∫nico responsable del cumplimiento de las normativas locales vigentes relacionadas con la actividad de pr√©stamo de dinero.</p>
        <p>4. Los datos almacenados se tratar√°n conforme a la Ley 25.326 de Protecci√≥n de Datos Personales.</p>
        <p>5. El uso de la firma electr√≥nica tiene plena validez seg√∫n la Ley 25.506.</p>
        <p>6. La plataforma act√∫a √∫nicamente como herramienta de gesti√≥n y no es parte de los contratos de pr√©stamo entre el prestador y sus clientes.</p>
      </div>

      <label class="ob-consent-check">
        <input type="checkbox" id="obConsentCheck"/>
        <span>Le√≠ y acepto los T√©rminos de Uso, incluyendo que la plataforma puede pausar o eliminar mi cuenta por incumplimiento de pagos o t√©rminos del servicio.</span>
      </label>

      <div style="margin-bottom:10px">
        <div style="font-size:11px;font-weight:700;color:var(--ice);text-transform:uppercase;letter-spacing:.9px;margin-bottom:8px">Firma digital (Ley 25.506)</div>
        <div class="ob-sig-wrap"><canvas id="obSigCanvas"></canvas></div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="btnObClearSig" class="btn-outline btn-sm">Borrar firma</button>
          <span style="font-size:11px;color:var(--muted);align-self:center">Firm√° con el dedo o el mouse</span>
        </div>
      </div>

      <div class="ob-nav">
        <button id="btnObStep1" class="btn-primary" style="flex:1">Continuar al paso 2 ‚Üí</button>
      </div>
    </div>

    <!-- PASO 2: Nombre de tu financiera -->
    <div class="ob-content" id="obContent2">
      <div class="ob-title">Nombre de tu financiera</div>
      <div class="ob-subtitle">Estos datos aparecer√°n en el portal de clientes y en los contratos.</div>
      <div class="field"><label>Nombre de la financiera</label><input id="obAppName" placeholder="FinancieraYa / Pr√©stamos P√©rez"/></div>
      <div class="field"><label>Ciudad de operaci√≥n</label><input id="obCity" placeholder="R√≠o Gallegos, Santa Cruz"/></div>
      <div class="field"><label>WhatsApp de contacto (ej: 5492966123456)</label><input id="obWa" inputmode="tel" placeholder="5492966123456"/></div>
      <div class="ob-nav">
        <button id="btnObBack1" class="btn-outline" style="flex:0 0 auto">‚Üê Atr√°s</button>
        <button id="btnObStep2" class="btn-primary" style="flex:1">Continuar al paso 3 ‚Üí</button>
      </div>
    </div>

    <!-- PASO 3: Montos y TNA -->
    <div class="ob-content" id="obContent3">
      <div class="ob-title">Configuraci√≥n de montos y TNA</div>
      <div class="ob-subtitle">Configur√° los par√°metros financieros de tu financiera. Pod√©s cambiarlos despu√©s desde Configuraci√≥n.</div>
      <div class="input-row">
        <div class="field"><label>TNA % (tasa nominal anual)</label><input id="obTna" inputmode="numeric" class="mono" placeholder="90"/></div>
        <div class="field"><label>D√≠a de vencimiento (1-28)</label><input id="obDueDay" inputmode="numeric" placeholder="10"/></div>
      </div>
      <div class="input-row">
        <div class="field"><label>Monto m√≠nimo ($)</label><input id="obMinAmount" inputmode="numeric" class="mono" placeholder="10000"/></div>
        <div class="field"><label>Monto m√°ximo ($)</label><input id="obMaxAmount" inputmode="numeric" class="mono" placeholder="5000000"/></div>
      </div>
      <div class="field"><label>% Gasto de otorgamiento (por defecto 3%)</label><input id="obExpenses" inputmode="numeric" class="mono" placeholder="3"/><p class="field-hint">Se descuenta del capital al momento de entregar el pr√©stamo (Sistema Franc√©s).</p></div>
      <div class="payment-method-selector">
        <div class="pm-option selected" id="pmOptMP" onclick="selectPayMethod('mp')">
          <div class="pm-icon">üí≥</div>
          <div class="pm-name">Mercado Pago</div>
          <div class="pm-desc">Cobro autom√°tico online. Requiere Access Token.</div>
        </div>
        <div class="pm-option" id="pmOptManual" onclick="selectPayMethod('manual')">
          <div class="pm-icon">üè¶</div>
          <div class="pm-name">Transferencia manual</div>
          <div class="pm-desc">El cliente transfiere y sube comprobante. Vos lo verific√°s.</div>
        </div>
      </div>
      <div id="obMpFields">
        <div class="field"><label>Access Token de producci√≥n</label><input id="obMpToken" type="password" placeholder="APP_USR-xxxxxxxxxxxx"/><p class="field-hint">Obtenelo en Mercado Pago ‚Üí Tu negocio ‚Üí Credenciales.</p></div>
        <div class="field"><label>Public Key</label><input id="obMpPublicKey" placeholder="APP_USR-xxxxxxxxxxxx"/></div>
      </div>
      <div id="obManualMsg" style="display:none;padding:14px;background:rgba(245,158,11,.06);border:1px solid rgba(245,158,11,.2);border-radius:12px;margin-bottom:16px">
        <p style="font-size:13px;color:#fbbf24;font-weight:700;margin-bottom:4px">üìã Modo transferencia manual activo</p>
        <p style="font-size:12px;color:var(--muted);line-height:1.55">Tus clientes ver√°n instrucciones para transferir y subir comprobante. Vos los aprob√°s desde el panel de Comprobantes.</p>
      </div>
      <div class="ob-nav">
        <button id="btnObBack2" class="btn-outline" style="flex:0 0 auto">‚Üê Atr√°s</button>
        <button id="btnObFinish" class="btn-primary" style="flex:1;background:linear-gradient(135deg,#059669,var(--ok))">‚úì Crear mi cuenta</button>
      </div>
    </div>
  </div>
</div>

<div class="toast-container" id="toastContainer"></div>

<!-- BANNER NUEVA SOLICITUD EN TIEMPO REAL -->
<div class="alert-banner" id="alertBanner">
  <span style="font-size:20px;flex-shrink:0">üîî</span>
  <span id="alertBannerText">Nueva solicitud recibida</span>
  <button class="alert-banner-close" id="alertBannerClose" title="Cerrar">‚úï</button>
</div>

<!-- TOPBAR -->
<header class="topbar">
  <div class="topbar-inner">
    <a href="#" class="logo" id="logoLink">
      <div class="logo-mark" id="logoMark">P</div>
      <span class="logo-name" id="logoName">Presti<span>fy</span></span>
    </a>
    <nav class="topbar-nav">
      <button id="btnViewClient" class="nav-btn active">
        <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        <span class="nav-label">Cliente</span>
      </button>
      <button id="btnViewAdmin" class="nav-btn">
        <svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        <span class="nav-label">Admin</span>
      </button>
      <button id="btnViewSuperAdmin" class="nav-btn" style="display:none">
        <svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><circle cx="12" cy="12" r="3" fill="currentColor" stroke="none"/></svg>
        <span class="nav-label">SuperAdmin</span>
      </button>
      <div class="nav-sep"></div>
      <div class="notif-wrap" id="notifWrap" style="display:none">
        <button class="notif-bell" id="notifBell" title="Notificaciones">
          <svg viewBox="0 0 24 24"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
          <span class="notif-badge" id="notifBadge" style="display:none">0</span>
        </button>
        <div class="notif-dropdown" id="notifDropdown">
          <div class="notif-header">
            <span>Alertas en tiempo real</span>
            <button id="btnClearNotifs" class="btn-outline btn-sm">Limpiar</button>
          </div>
          <div class="notif-list" id="notifList"><div class="notif-empty">Sin notificaciones</div></div>
        </div>
      </div>
      <button id="btnResetPass" class="nav-btn">
        <svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
        <span class="nav-label">Llave</span>
      </button>
      <button id="btnLogout" class="nav-btn danger" style="display:none">
        <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
        <span class="nav-label">Salir</span>
      </button>
    </nav>
  </div>
</header>

<!-- HERO -->
<section class="hero-section" id="heroSection">
  <div>
    <div class="hero-eyebrow" id="heroEyebrow">Prestify ¬∑ Tu financiera, digitalizada</div>
    <h1 class="hero-title">Pr√©stamos personales<br><em>r√°pidos y seguros</em></h1>
    <p class="hero-sub">Simul√°, solicit√° y gestion√° tu pr√©stamo en minutos. Sin papeles ni filas.</p>
    <div class="hero-badges">
      <div class="badge"><svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>SSL Seguro</div>
      <div class="badge"><svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>Datos protegidos</div>
      <div class="badge"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>Sin burocracia</div>
    </div>
  </div>
  <div class="hero-kpis">
    <div class="kpi-box"><div class="kpi-label">TNA vigente</div><div class="kpi-value" id="heroTna">&#8212;<small>%</small></div></div>
    <div class="kpi-box"><div class="kpi-label">D√≠a de pago</div><div class="kpi-value" id="heroDue">&#8212;<small>del mes</small></div></div>
  </div>
</section>

<!-- MAIN -->
<main class="main-wrap">

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ VISTA CLIENTE ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="clientView">
    <!-- Lender brand header (only shows in client mode) -->
    <div class="lender-brand-header" id="lenderBrandHeader" style="display:none">
      <div class="lender-brand-name" id="lenderBrandName">Mi Financiera</div>
      <div class="lender-brand-tagline">Pr√©stamos r√°pidos y seguros</div>
    </div>

    <div class="client-grid">
      <!-- Simulador -->
      <div class="card">
        <div class="card-title"><svg viewBox="0 0 24 24"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>Simulador de cuotas</div>
        <div class="sim-meta">
          <div class="sim-meta-item">TNA <strong id="lblTna">--%</strong></div>
          <div class="sim-meta-item">Vence d√≠a <strong id="lblDue">--</strong></div>
          <div class="sim-meta-item">Gasto otorg. <strong id="lblGastoOtorg">3%</strong></div>
          <div class="sim-meta-item" id="lblExpMeta" style="display:none">Gastos admin <strong id="lblExp">--%</strong></div>
        </div>
        <!-- Client mode: amount slider -->
        <div id="clientAmountWrap" style="display:none">
          <div class="client-amount-label">¬øCu√°nto necesit√°s?</div>
          <div class="client-amount-display" id="clientAmountDisplay">$ 50.000</div>
          <input type="range" id="clientAmountSlider" class="client-amount-slider"
            min="5000" max="1000000" step="5000" value="50000"/>
          <div style="display:flex;justify-content:space-between;font-size:11px;color:#aaa;margin-bottom:10px">
            <span id="sliderMinLabel">$ 5.000</span><span id="sliderMaxLabel">$ 1.000.000</span>
          </div>
          <div class="field" style="margin-bottom:14px">
            <label style="font-size:11px;color:#888;text-transform:uppercase;letter-spacing:.8px;font-weight:600;margin-bottom:5px;display:block">O ingres√° el monto manualmente</label>
            <input id="clientAmountManual" inputmode="numeric" placeholder="Ej: 2.500.000"
              style="background:#F5F7FA;border:1.5px solid #E2E8F0;border-radius:14px;padding:11px 15px;width:100%;font-family:'Sora',sans-serif;font-size:15px;font-weight:700;color:#111;outline:none;transition:border-color .2s"/>
          </div>
          <input type="hidden" id="simAmount" value="50000"/>
        </div>
        <!-- Admin mode: text input -->
        <div id="adminAmountWrap">
          <div class="input-row">
            <div class="field"><label>Monto solicitado por el cliente</label><input id="simAmountInput" class="mono" inputmode="numeric" placeholder="$ 500.000"/></div>
          </div>
        </div>
        <!-- Plazo selector: admin uses <select>, client uses pills -->
        <div id="adminPlazoWrap">
          <div class="field"><label>Plazo en meses</label><select id="simMonths"><option value="">‚Äî Seleccion√° un plazo ‚Äî</option></select></div>
        </div>
        <div id="clientPillsWrap" style="display:none">
          <div style="font-size:13px;font-weight:600;color:#444;margin-bottom:10px">Eleg√≠ el plazo</div>
          <div class="client-pills-wrap" id="clientPillsContainer"></div>
          <input type="hidden" id="simMonthsHidden" value=""/>
        </div>

        <div id="simDeductionBadge" style="display:none" class="sim-deduction-badge">
          <svg viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
          Se descontar√°n <strong id="simExpAmt">$0</strong> en gastos administrativos al acreditar.
        </div>
        <button id="btnSim" class="btn-primary"><svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>Calcular cuotas</button>
        <div id="simResult"></div>
      </div>

      <!-- Solicitud -->
      <div class="card">
        <div class="card-title"><svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>Nueva solicitud</div>
        <div class="input-row">
          <div class="field"><label>Nombre y apellido</label><input id="bName" placeholder="Juan P√©rez"/></div>
          <div class="field"><label>DNI</label><input id="bDni" inputmode="numeric" placeholder="30123456"/></div>
        </div>
        <div class="input-row">
          <div class="field"><label>Email</label><input id="bEmail" type="email" placeholder="correo@mail.com"/></div>
          <div class="field"><label>Tel√©fono (WhatsApp)</label><input id="bPhone" inputmode="tel" placeholder="2966 123456"/></div>
        </div>
        <div class="field"><label>Alias o CBU / CVU</label><input id="bAlias" placeholder="alias.banco o 22 d√≠gitos"/></div>
        <div class="sep"></div>
        <p id="simHintText" style="font-size:12px;color:var(--muted);margin-bottom:14px;line-height:1.55">El monto y plazo se toman del Simulador. Completalo primero.</p>
        <button id="btnSendReq" class="btn-primary" style="background:linear-gradient(135deg,#0f766e,#0d9488)"><svg viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>Enviar solicitud</button>
      </div>

      <!-- Mi pr√©stamo -->
      <div class="card full-width" id="myloan">
        <div class="card-title"><svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>Consultar mi pr√©stamo</div>
        <div style="display:grid;grid-template-columns:1fr auto;gap:12px;align-items:end;max-width:420px">
          <div class="field" style="margin-bottom:0"><label>Ingres√° tu DNI</label><input id="myDni" inputmode="numeric" placeholder="Ej: 30123456"/></div>
          <button id="btnFindMyLoan" class="btn-primary" style="width:auto;padding:12px 22px">Buscar</button>
        </div>
        <div id="myLoanResult"></div>
      </div>
    </div>

    <!-- Prestify footer (only in client mode) -->
    <div class="prestify-footer" id="prestifyFooter" style="display:none">
      Potenciado por <strong>Prestify</strong> | Tu financiera, digitalizada
    </div>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ VISTA ADMIN ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="adminView" class="admin-wrap">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:10px">
      <div>
        <h2 style="font-size:20px;font-weight:800;color:var(--white);margin-bottom:2px">Panel de Administraci√≥n ‚Äî <span id="adminDashTitle" style="color:var(--sky)">Mi Financiera</span></h2>
        <p style="font-size:13px;color:var(--muted)" id="adminUserLabel"></p>
      </div>
      <button id="btnAdminLogin" class="btn-outline">Iniciar sesi√≥n de admin</button>
    </div>

    <div id="adminGate">
      <div class="auth-gate-box">
        <div class="auth-gate-icon"><svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg></div>
        <div class="auth-gate-title">Acceso restringido</div>
        <div class="auth-gate-sub">Inici√° sesi√≥n con tus credenciales de administrador para acceder al panel.</div>
        <button id="btnAdminLogin2" class="btn-primary">Iniciar sesi√≥n</button>
      </div>
    </div>

    <div id="adminContent" style="display:none">
      <!-- KPIs -->
      <div class="dashboard-grid">
        <div class="dash-card blue">
          <div class="dash-icon blue"><svg viewBox="0 0 24 24"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg></div>
          <div class="dash-label">Capital total prestado</div>
          <div class="dash-value" id="kpiInvested">$ 0</div>
          <div class="dash-sub" id="kpiActiveCount">0 pr√©stamos activos</div>
        </div>
        <div class="dash-card green">
          <div class="dash-icon green"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>
          <div class="dash-label">Total recuperado</div>
          <div class="dash-value" id="kpiRecovered">$ 0</div>
          <div class="dash-sub" id="kpiPaidCount">0 cuotas cobradas</div>
        </div>
        <div class="dash-card red">
          <div class="dash-icon red"><svg viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg></div>
          <div class="dash-label">Capital en mora</div>
          <div class="dash-value" id="kpiMora">$ 0</div>
          <div class="dash-sub" id="kpiMoraCount">0 cuotas vencidas</div>
        </div>
        <div class="dash-card orange">
          <div class="dash-icon orange"><svg viewBox="0 0 24 24"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg></div>
          <div class="dash-label">Tasa de mora</div>
          <div class="dash-value" id="kpiMoraRate">0%</div>
          <div class="mora-rate-bar"><div class="mora-rate-fill" id="kpiMoraBar" style="width:0%"></div></div>
        </div>
        <div class="dash-card purple">
          <div class="dash-icon purple"><svg viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
          <div class="dash-label">Rentabilidad proyectada</div>
          <div class="dash-value" id="kpiProfit">$ 0</div>
          <div class="dash-sub">Intereses sistema franc√©s</div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="admin-tabs">
        <button class="tab-btn active" data-tab="Cfg">‚öôÔ∏è Configuraci√≥n</button>
        <button class="tab-btn" data-tab="Pending">Pendientes <span class="tab-badge" id="badgePend">0</span></button>
        <button class="tab-btn" data-tab="Pre">Preaprobados <span class="tab-badge" id="badgePre">0</span></button>
        <button class="tab-btn" data-tab="Active">Activos <span class="tab-badge" id="badgeAct">0</span></button>
        <button class="tab-btn" data-tab="Mora">‚ö†Ô∏è Mora <span class="tab-badge warn" id="badgeMora">0</span></button>
        <button class="tab-btn" data-tab="Comprobantes">üßæ Comprobantes <span class="tab-badge warn" id="badgeComp">0</span></button>
        <button class="tab-btn" data-tab="History">Hist√≥rico</button>
      </div>

      <!-- CFG -->
      <div class="tab-content visible" id="tabCfg">
        <div class="card">
          <div class="card-title">Configuraci√≥n del sistema</div>
          <div class="cfg-section">
            <div class="cfg-section-title"><svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="3"/><path d="M3 9h18M9 21V9"/></svg>Identidad del negocio</div>
            <div class="logo-upload-wrap">
              <div class="logo-preview-box" id="cfgLogoPreview">DY</div>
              <div class="logo-upload-info"><h4>Logo del negocio</h4><p>PNG o JPG. Aparece en topbar y contratos.</p></div>
              <div>
                <label for="cfgLogoFile" class="btn-outline btn-sm" style="cursor:pointer;display:inline-flex">
                  <svg viewBox="0 0 24 24" style="width:13px;height:13px;stroke:currentColor;fill:none;stroke-width:2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>Subir</label>
                <input type="file" id="cfgLogoFile" accept="image/*" style="display:none"/>
              </div>
            </div>
            <div class="input-row">
              <div class="field"><label>Nombre del negocio</label><input id="cfgAppName" placeholder="DineroYa"/></div>
              <div class="field"><label>Ciudad de operaci√≥n</label><input id="cfgCity" placeholder="R√≠o Gallegos, Santa Cruz"/></div>
            </div>
            <div class="field">
              <label>Color de tu Marca</label>
              <div style="display:flex;align-items:center;gap:12px">
                <input type="color" id="cfgBrandColor" value="#1a56db" style="width:48px;height:40px;border:none;background:none;cursor:pointer;border-radius:8px;padding:2px"/>
                <span style="font-size:12px;color:var(--muted)">Este color se aplica al portal de clientes (slider, botones, CTA).</span>
              </div>
            </div>
          </div>
          <div class="cfg-section">
            <div class="cfg-section-title"><svg viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>Tasas y condiciones</div>
            <div class="input-row">
              <div class="field"><label>TNA %</label><input id="cfgTna" inputmode="numeric" class="mono" placeholder="100"/></div>
              <div class="field"><label>D√≠a de vencimiento (1-28)</label><input id="cfgDue" inputmode="numeric" placeholder="10"/></div>
            </div>
            <div class="field">
              <label>Plazos disponibles (meses)</label>
              <p class="field-hint" style="margin-bottom:10px">Seleccion√° los plazos que ofrec√©s a tus clientes. Solo estos aparecer√°n en el simulador.</p>
              <div class="plazo-grid" id="plazoGrid">
                  <input type="checkbox" class="plazo-check" id="plazo1" value="1"/><label class="plazo-label" for="plazo1">1</label>
                  <input type="checkbox" class="plazo-check" id="plazo2" value="2"/><label class="plazo-label" for="plazo2">2</label>
                  <input type="checkbox" class="plazo-check" id="plazo3" value="3"/><label class="plazo-label" for="plazo3">3</label>
                  <input type="checkbox" class="plazo-check" id="plazo4" value="4"/><label class="plazo-label" for="plazo4">4</label>
                  <input type="checkbox" class="plazo-check" id="plazo5" value="5"/><label class="plazo-label" for="plazo5">5</label>
                  <input type="checkbox" class="plazo-check" id="plazo6" value="6"/><label class="plazo-label" for="plazo6">6</label>
                  <input type="checkbox" class="plazo-check" id="plazo7" value="7"/><label class="plazo-label" for="plazo7">7</label>
                  <input type="checkbox" class="plazo-check" id="plazo8" value="8"/><label class="plazo-label" for="plazo8">8</label>
                  <input type="checkbox" class="plazo-check" id="plazo9" value="9"/><label class="plazo-label" for="plazo9">9</label>
                  <input type="checkbox" class="plazo-check" id="plazo10" value="10"/><label class="plazo-label" for="plazo10">10</label>
                  <input type="checkbox" class="plazo-check" id="plazo11" value="11"/><label class="plazo-label" for="plazo11">11</label>
                  <input type="checkbox" class="plazo-check" id="plazo12" value="12"/><label class="plazo-label" for="plazo12">12</label>
                  <input type="checkbox" class="plazo-check" id="plazo13" value="13"/><label class="plazo-label" for="plazo13">13</label>
                  <input type="checkbox" class="plazo-check" id="plazo14" value="14"/><label class="plazo-label" for="plazo14">14</label>
                  <input type="checkbox" class="plazo-check" id="plazo15" value="15"/><label class="plazo-label" for="plazo15">15</label>
                  <input type="checkbox" class="plazo-check" id="plazo16" value="16"/><label class="plazo-label" for="plazo16">16</label>
                  <input type="checkbox" class="plazo-check" id="plazo17" value="17"/><label class="plazo-label" for="plazo17">17</label>
                  <input type="checkbox" class="plazo-check" id="plazo18" value="18"/><label class="plazo-label" for="plazo18">18</label>
                  <input type="checkbox" class="plazo-check" id="plazo19" value="19"/><label class="plazo-label" for="plazo19">19</label>
                  <input type="checkbox" class="plazo-check" id="plazo20" value="20"/><label class="plazo-label" for="plazo20">20</label>
                  <input type="checkbox" class="plazo-check" id="plazo21" value="21"/><label class="plazo-label" for="plazo21">21</label>
                  <input type="checkbox" class="plazo-check" id="plazo22" value="22"/><label class="plazo-label" for="plazo22">22</label>
                  <input type="checkbox" class="plazo-check" id="plazo23" value="23"/><label class="plazo-label" for="plazo23">23</label>
                  <input type="checkbox" class="plazo-check" id="plazo24" value="24"/><label class="plazo-label" for="plazo24">24</label>
              </div>
              <div style="display:flex;gap:8px;margin-top:8px">
                <button type="button" id="btnSelAllPlazos" class="btn-outline btn-sm">Seleccionar todos</button>
                <button type="button" id="btnClearPlazos" class="btn-outline btn-sm">Limpiar</button>
              </div>
            </div>
            <div class="input-row">
              <div class="field">
                <label>% Gastos administrativos</label>
                <input id="cfgExpenses" inputmode="numeric" placeholder="0" class="mono"/>
                <p class="field-hint">Se descuenta del capital a entregar. Ej: 5% de $100.000 = $5.000 menos.</p>
              </div>
              <div class="field"><label>WhatsApp del prestamista</label><input id="cfgWa" inputmode="tel" placeholder="5492966123456"/></div>
            </div>
            <div class="field">
              <label>Monto M√°ximo a Prestar</label>
              <input id="cfgMaxAmount" inputmode="numeric" class="mono" placeholder="1.000.000"/>
              <p class="field-hint">Este valor define el m√°ximo del slider en el portal de clientes. Por defecto: $ 1.000.000.</p>
            </div>
          </div>
          <div class="cfg-section">
            <div class="cfg-section-title"><svg viewBox="0 0 24 24"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>Mi Link Prestify</div>
            <p style="font-size:12px;color:var(--muted);margin-bottom:12px;line-height:1.6">Compart√≠ este link con tus clientes. Sus solicitudes llegar√°n directamente a tu panel.</p>
            <div id="myLinkPreview" style="font-family:'DM Mono',monospace;font-size:12px;color:var(--sky);padding:10px 14px;background:rgba(26,86,219,.08);border:1px solid var(--border);border-radius:10px;margin-bottom:12px;word-break:break-all"></div>
            <button id="btnCopyMyLink" class="btn-copy-link">
              <svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copiar mi Link Prestify
            </button>
          </div>
          <div class="cfg-section">
            <div class="cfg-section-title"><svg viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>Mercado Pago (cobro autom√°tico)</div>
            <div id="mpStatusBadge"></div>
            <div class="input-row">
              <div class="field">
                <label>Access Token de producci√≥n</label>
                <input id="cfgMpToken" type="password" placeholder="APP_USR-xxxxxxxxxxxx"/>
                <p class="field-hint">Obtenelo en tu cuenta MP ‚Üí Credenciales. Sin token, los clientes pagar√°n por transferencia + comprobante.</p>
              </div>
              <div class="field">
                <label>Public Key</label>
                <input id="cfgMpPublicKey" placeholder="APP_USR-xxxxxxxxxxxx"/>
                <p class="field-hint">Requerida para el bot√≥n de pago en el portal del cliente.</p>
              </div>
            </div>
            <p style="font-size:11px;color:var(--muted);margin-top:4px">üí° Para cambiar a <strong style="color:var(--ice)">transferencia manual</strong>, dej√° el Access Token en blanco y guard√°.</p>
          </div>
          <button id="btnSaveCfg" class="btn-success" style="padding:13px 32px;font-size:14px">Guardar configuraci√≥n</button>
        </div>
      </div>

      <!-- PENDIENTES -->
      <div class="tab-content" id="tabPending">
        <div class="card">
          <div class="card-title">Solicitudes pendientes</div>
          <div style="display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap">
            <input class="search-input" id="searchPend" placeholder="Buscar por nombre o DNI..." style="max-width:300px"/>
            <button id="btnReloadPend" class="btn-outline btn-sm">‚Ü∫ Recargar</button>
          </div>
          <div id="listPend"><div class="empty"><div class="spinner"></div></div></div>
        </div>
      </div>

      <!-- PREAPROBADOS -->
      <div class="tab-content" id="tabPre">
        <div class="card">
          <div class="card-title">Preaprobados</div>
          <div class="toolbar" style="margin-bottom:14px"><button id="btnReloadPre" class="btn-outline btn-sm">‚Ü∫ Recargar</button></div>
          <div id="listPre"><div class="empty">Sin preaprobados</div></div>
        </div>
      </div>

      <!-- ACTIVOS -->
      <div class="tab-content" id="tabActive">
        <div class="card">
          <div class="card-title">Cartera activa</div>
          <div style="display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap">
            <input class="search-input" id="searchAct" placeholder="Buscar pr√©stamo..." style="max-width:300px"/>
            <button id="btnReloadAct" class="btn-outline btn-sm">‚Ü∫ Recargar</button>
          </div>
          <div id="listAct"><div class="empty">Sin activos</div></div>
        </div>
      </div>

      <!-- MORA -->
      <div class="tab-content" id="tabMora">
        <div class="card">
          <div class="card-title">‚ö†Ô∏è Reporte de mora</div>
          <div class="toolbar" style="margin-bottom:14px"><button id="btnReloadMora" class="btn-outline btn-sm">‚Ü∫ Recargar</button></div>
          <div class="mora-summary" id="moraSummary" style="display:none">
            <div class="mora-sum-box"><div class="mora-sum-value" id="moraTotal">$ 0</div><div class="mora-sum-label">Capital en mora</div></div>
            <div class="mora-sum-box"><div class="mora-sum-value" id="moraDeudores">0</div><div class="mora-sum-label">Deudores</div></div>
            <div class="mora-sum-box"><div class="mora-sum-value" id="moraMaxDias">0</div><div class="mora-sum-label">D√≠as m√°x. atraso</div></div>
          </div>
          <div class="mora-table" id="listMora"><div class="empty"><div class="spinner"></div></div></div>
        </div>
      </div>

      <!-- COMPROBANTES -->
      <div class="tab-content" id="tabComprobantes">
        <div class="card">
          <div class="card-title">üßæ Comprobantes pendientes de verificaci√≥n</div>
          <p style="font-size:12px;color:var(--muted);margin-bottom:14px;line-height:1.55">Clientes en modo pago manual que subieron capturas de transferencia. Verific√° y aprob√° cada cuota.</p>
          <div class="toolbar" style="margin-bottom:14px"><button id="btnReloadComp" class="btn-outline btn-sm">‚Ü∫ Recargar</button></div>
          <div id="listComp"><div class="empty"><div class="spinner"></div></div></div>
        </div>
      </div>

      <!-- HISTORICO -->
      <div class="tab-content" id="tabHistory">
        <div class="card">
          <div class="card-title">Hist√≥rico</div>
          <div class="toolbar" style="margin-bottom:14px">
            <button class="btn-outline btn-sm" id="btnTabPaid">Saldados</button>
            <button class="btn-danger btn-sm" id="btnTabCharged">Incobrables</button>
            <button class="btn-outline btn-sm" id="btnReloadInact">‚Ü∫ Recargar</button>
          </div>
          <div id="listInact"><div class="empty">Sin registros</div></div>
        </div>
      </div>
    </div><!-- /adminContent -->
  </div><!-- /adminView -->

</main>

<!-- MODAL FIRMA -->
<div class="modal-overlay" id="sigModal">
  <div class="modal-box">
    <div class="modal-title">Firma digital del contrato</div>
    <div class="modal-sub">Firm√° con el dedo en el recuadro. Tiene validez legal seg√∫n la <strong style="color:var(--sky)">Ley 25.506</strong>.</div>
    <div class="sig-canvas-wrap"><canvas id="sigCanvas"></canvas></div>
    <div class="sig-actions">
      <button id="btnClearSig" class="btn-outline">Borrar</button>
      <button id="btnConfirmSig" class="btn-success" style="flex:2">Confirmar firma</button>
    </div>
    <button id="btnCancelSig" class="btn-outline" style="width:100%;margin-top:8px">Cancelar</button>
    <p class="modal-note">Al confirmar declar√°s que esta firma electr√≥nica tiene la misma validez que la firma ol√≥grafa (Ley 25.506).</p>
  </div>
</div>

<!-- MODAL ACTIVAR -->
<div class="modal-overlay" id="activateModal">
  <div class="modal-box">
    <div class="modal-title">Activar pr√©stamo</div>
    <div class="modal-sub">Revis√° el resumen antes de activar. Este paso genera el calendario de pagos.</div>
    <div class="activate-summary" id="activateSummary"></div>
    <div style="display:flex;gap:10px">
      <button id="btnCancelActivate" class="btn-outline" style="flex:1">Cancelar</button>
      <button id="btnConfirmActivate" class="btn-success" style="flex:2">Confirmar activaci√≥n</button>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp }   from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, sendPasswordResetEmail }
  from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
import { getFirestore, collection, doc, getDoc, getDocs, setDoc, addDoc, updateDoc, deleteDoc,
         serverTimestamp, query, where, orderBy, limit, onSnapshot, writeBatch }
  from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";
import { getStorage, ref as sRef, uploadString, getDownloadURL }
  from "https://www.gstatic.com/firebasejs/10.12.5/firebase-storage.js";

/* ‚ïê‚ïê FIREBASE CONFIG ‚ïê‚ïê */
const firebaseConfig = {
  apiKey:"AIzaSyBuLQHhsOBTr2e8Kp5HKUz-a7xXgrgLlUI",
  authDomain:"estimapres.firebaseapp.com",
  projectId:"estimapres",
  storageBucket:"estimapres.firebasestorage.app",
  messagingSenderId:"578516597437",
  appId:"1:578516597437:web:f59994b87729aa1cd655d4"
};
const app     = initializeApp(firebaseConfig);
const auth    = getAuth(app);
const db      = getFirestore(app);
const storage = getStorage(app);

/* ‚ïê‚ïê UTILS ‚ïê‚ïê */
const fmtMoney = n => isNaN(n)||n==null ? "$ 0" : "$ "+Number(Math.round(n)).toLocaleString("es-AR");
const digits   = v => (v||"").replace(/\D+/g,"");
const nowTS    = () => serverTimestamp();
const daysLate = iso => Math.max(0,Math.floor((Date.now()-new Date(iso).getTime())/86400000));
const el       = id => document.getElementById(id);

function toast(msg,type="info",dur=3800){
  const c=el("toastContainer");
  const t=document.createElement("div"); t.className=`toast ${type}`; t.textContent=msg;
  c.appendChild(t); setTimeout(()=>t.remove(),dur);
}
function annuity(P,rate,m){
  const i=(rate/100)/12; if(i===0) return P/m;
  return P*i*Math.pow(1+i,m)/(Math.pow(1+i,m)-1);
}
function scheduleRows(L){
  const due=L.dueDay||10;
  const base=L.activeAt?.toDate?L.activeAt.toDate():new Date();
  const gastoOtorg=L.gastoOtorgAmt||Math.round((L.amount||0)*GASTO_OTORGAMIENTO/100);
  const capFin=L.capitalFinanciar||(L.amount||0)+gastoOtorg;
  const inst=(L.installment&&L.installment>0)?L.installment:Math.round(annuity(capFin,L.tna,L.months));
  return Array.from({length:L.months},(_,k)=>{
    const d=new Date(base.getFullYear(),base.getMonth()+k+1,1);
    d.setDate(Math.min(due,28));
    return{n:k+1,due:d.toISOString().slice(0,10),amount:inst,paid:(L.paidCount||0)>k};
  });
}

/* ‚ïê‚ïê ESTADO ‚ïê‚ïê */
let gUser=null, gLenderId=null, gRefLenderId=null;
let gSettings={tna:null,dueDay:null,appName:"Prestify",city:"R√≠o Gallegos, Santa Cruz",expenses:0,wa:"",logoBase64:"",mpToken:"",mpPublicKey:"",status:"activo",plazos:[3,6,9,12,18,24],brandColor:"#1a56db",maxAmount:1000000};
const GASTO_OTORGAMIENTO=3;
const SUPER_ADMIN_UID="CuQqbuHWkTWdFPdknVTUAkx5Xri2";
const OWNER_EMAIL = "fernandogastondelgado81@gmail.com";
let gActivateLoan=null, inactTab="paid";
let gNotifications=[], gSnapshotUnsub=null, gStatusUnsub=null, knownPendingIds=new Set();
let gObSigData=null, gObPayMethod="mp";

/* ‚ïê‚ïê ?ref= MULTITENANT ‚ïê‚ïê */
(()=>{
  const params=new URLSearchParams(location.search);
  gRefLenderId=params.get("ref")||null;
  if(gRefLenderId) sessionStorage.setItem("prestify_ref",gRefLenderId);
  else {
    const stored=sessionStorage.getItem("prestify_ref");
    if(stored) gRefLenderId=stored;
  }
})();

// ===== INTERSECTION OBSERVER (animaciones) =====
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('show');
    }
  });
}, { threshold: 0.1 });
setTimeout(() => {
  document.querySelectorAll('.fade-up, .fade-left, .fade-right, .fade-in').forEach(el => observer.observe(el));
}, 500);

// ===== SUPERADMIN FUNCTIONS =====
window.loadSuperAdmin = async function() {
  const listEl = el("saLendersList");
  if (!listEl) return;
  listEl.innerHTML = '<div class="sa-loading"><div class="spinner"></div></div>';
  try {
    const lendersSnap = await getDocs(collection(db, "lenders"));
    const lenders = [];
    lendersSnap.forEach(d => lenders.push({ id: d.id, ...d.data() }));

    const loansSnap = await getDocs(collection(db, "loans"));
    const totalLoans = loansSnap.size;
    let totalVolume = 0;
    loansSnap.forEach(d => totalVolume += d.data().amount || 0);

    const activos = lenders.filter(l => l.status === "activo").length;
    const pendientes = lenders.filter(l => l.status === "pendiente").length;

    el("saCountLenders").textContent = lenders.length;
    el("saCountActive").textContent = activos;
    el("saCountPending").textContent = pendientes;
    el("saCountLoans").textContent = totalLoans;
    el("saVolume").textContent = fmtMoney(totalVolume);

    if (lenders.length === 0) {
      listEl.innerHTML = '<div class="empty">No hay prestamistas</div>';
      return;
    }

    lenders.sort((a, b) => {
      const order = { pendiente: 0, activo: 1, pausado: 2 };
      return (order[a.status] ?? 3) - (order[b.status] ?? 3);
    });

    let html = '';
    lenders.forEach(l => {
      const status = l.status || "pendiente";
      const statusClass = status === "activo" ? "activo" : status === "pendiente" ? "pendiente" : "pausado";
      const statusText = status === "activo" ? "‚úì Activo" : status === "pendiente" ? "‚è≥ Pendiente" : "‚õî Pausado";
      const operatorName = l.operator?.name || l.appName || "‚Äî";
      const operatorEmail = l.operator?.email || l.email || "‚Äî";
      
      let botones = '';
      if (status === "pendiente") {
        botones = `<button class="sa-action-btn sa-btn-activate" onclick="window.saSetStatus('${l.id}','activo')">‚úì Activar</button>`;
      } else if (status === "activo") {
        botones = `<button class="sa-action-btn sa-btn-suspend" onclick="window.saSetStatus('${l.id}','pausado')">‚õî Pausar</button>`;
      } else if (status === "pausado") {
        botones = `<button class="sa-action-btn sa-btn-activate" onclick="window.saSetStatus('${l.id}','activo')">‚Ü© Reactivar</button>`;
      }
      botones += `<button class="sa-action-btn sa-btn-suspend" style="margin-left:5px" onclick="window.saEliminar('${l.id}')">‚úï Eliminar</button>`;
      
      html += `<div class="sa-row">
        <div><span class="sa-lender-name">${operatorName}</span><div class="sa-lender-email">${operatorEmail}</div></div>
        <div>${l.wa || "‚Äî"}</div>
        <div><span class="sa-status-pill ${statusClass}">${statusText}</span></div>
        <div style="display:flex;gap:8px;flex-wrap:wrap">${botones}</div>
      </div>`;
    });
    listEl.innerHTML = html;
  } catch (e) {
    listEl.innerHTML = `<div class="empty">Error: ${e.message}</div>`;
    console.error(e);
  }
};

window.saSetStatus = async (lenderId, newStatus) => {
  try {
    await setDoc(doc(db, "lenders", lenderId), { status: newStatus, updatedAt: nowTS() }, { merge: true });
    await setDoc(doc(db, "settings", lenderId), { status: newStatus, updatedAt: nowTS() }, { merge: true });
    toast(`Prestamista ${newStatus === "activo" ? "activado" : "suspendido"}`, newStatus === "activo" ? "ok" : "warn");
    loadSuperAdmin();
  } catch (e) { toast("Error: " + e.message, "err"); }
};

window.saEliminar = async (lenderId) => {
  if (!confirm("¬øEliminar PERMANENTEMENTE este prestamista y TODOS sus pr√©stamos?")) return;
  try {
    const loansSnap = await getDocs(query(collection(db, "loans"), where("lenderId", "==", lenderId)));
    const batch = writeBatch(db);
    loansSnap.docs.forEach(d => batch.delete(d.ref));
    batch.delete(doc(db, "settings", lenderId));
    batch.delete(doc(db, "lenders", lenderId));
    await batch.commit();
    toast("Prestamista eliminado", "ok");
    loadSuperAdmin();
  } catch (e) { toast("Error: " + e.message, "err"); }
};

// ===== AUTH (con due√±o por email) =====
onAuthStateChanged(auth, async (user) => {
  gUser = user;
  gLenderId = user ? user.uid : null;
  
  const saBtn = el("btnViewSuperAdmin");
  if (saBtn) {
    saBtn.style.display = (user && (user.uid === SUPER_ADMIN_UID || user.email === OWNER_EMAIL)) ? "" : "none";
  }

  const ok = !!user;
  el("adminGate").style.display = ok ? "none" : "";
  el("adminContent").style.display = ok ? "" : "none";
  el("btnAdminLogin").style.display = ok ? "none" : "";
  el("btnLogout").style.display = ok ? "" : "none";
  el("notifWrap").style.display = ok ? "" : "none";

  if (ok) {
    el("adminUserLabel").textContent = "Sesi√≥n: " + user.email + " ¬∑ Lender ID: " + user.uid.slice(0,8) + "...";
    hideLandingPage();

    if (user.uid === SUPER_ADMIN_UID || user.email === OWNER_EMAIL) {
      el("heroSection").style.display = "none";
      el("clientView").style.display = "none";
      el("adminView").className = "admin-wrap";
      el("superadminView")?.classList.add("show");
      loadSuperAdmin();
      return;
    }

    await loadSettings();
    if (checkSuspended()) return;
    if (checkPending()) { startStatusListener(); return; }
    const lenderSnap = await getDoc(lenderRef(gLenderId));
    if (!lenderSnap.exists() || !lenderSnap.data().onboardingDone) {
      showOnboarding();
    } else {
      showView("admin");
      await loadAllAdmin();
    }
    startRealtimeListener();
    startStatusListener();
  } else {
    if (saBtn) saBtn.style.display = "none";
    if (gSnapshotUnsub) { gSnapshotUnsub(); gSnapshotUnsub = null; }
    if (!gRefLenderId) {
      showLandingPage();
    } else {
      el("landingView")?.classList.remove("show");
      el("btnViewClient").style.display = "";
      el("btnViewAdmin").style.display = "";
      showView("client");
      await loadSettings();
    }
  }
});

// ===== RESTO DE FUNCIONES ORIGINALES (loadPend, loadPre, etc.) =====
// ... (todo el c√≥digo original se mantiene aqu√≠) ...

// ===== BOTONES DE NAVEGACI√ìN =====
el("btnViewSuperAdmin")?.addEventListener("click", () => {
  el("superadminView").classList.add("show");
  el("landingView").classList.remove("show");
  el("clientView").style.display = "none";
  el("adminView").style.display = "none";
  loadSuperAdmin();
});

// ... (aqu√≠ contin√∫a el resto del c√≥digo original) ...

</script>
</body>
</html>